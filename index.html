<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dual Bet Physics Dice - 6x Payout</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 25px;
        }

        header {
            text-align: center;
            margin-bottom: 10px;
        }

        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .subtitle {
            font-size: 1.2rem;
            color: #ffd700;
            font-weight: bold;
        }

        .dice-area {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .dice-container {
            width: 380px;
            height: 380px;
            background: #1a252f;
            border-radius: 20px;
            position: relative;
            overflow: hidden;
            border: 2px solid #34495e;
            cursor: pointer;
            perspective: 1000px;
        }

        #physicsDice {
            position: absolute;
            width: 80px;
            height: 80px;
            transform-style: preserve-3d;
            transition: transform 0.1s linear;
            left: 150px;
            top: 150px;
        }

        .cube-face {
            position: absolute;
            width: 80px;
            height: 80px;
            background: white;
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            backface-visibility: visible;
            border: 1px solid #333;
        }

        .face-1 { 
            background: #FF5252;
            transform: translateZ(40px);
        }
        .face-2 { 
            background: #4CAF50;
            transform: rotateY(180deg) translateZ(40px);
        }
        .face-3 { 
            background: #2196F3;
            transform: rotateY(90deg) translateZ(40px);
        }
        .face-4 { 
            background: #FFC107;
            transform: rotateY(-90deg) translateZ(40px);
        }
        .face-5 { 
            background: #9C27B0;
            transform: rotateX(-90deg) translateZ(40px);
        }
        .face-6 { 
            background: #FF9800;
            transform: rotateX(90deg) translateZ(40px);
        }

        .dot {
            position: absolute;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #333;
        }

        .face-1 .dot:nth-child(1) { top: 34px; left: 34px; }
        
        .face-2 .dot:nth-child(1) { top: 20px; left: 20px; }
        .face-2 .dot:nth-child(2) { top: 48px; left: 48px; }
        
        .face-3 .dot:nth-child(1) { top: 20px; left: 20px; }
        .face-3 .dot:nth-child(2) { top: 34px; left: 34px; }
        .face-3 .dot:nth-child(3) { top: 48px; left: 48px; }
        
        .face-4 .dot:nth-child(1) { top: 20px; left: 20px; }
        .face-4 .dot:nth-child(2) { top: 20px; left: 48px; }
        .face-4 .dot:nth-child(3) { top: 48px; left: 20px; }
        .face-4 .dot:nth-child(4) { top: 48px; left: 48px; }
        
        .face-5 .dot:nth-child(1) { top: 20px; left: 20px; }
        .face-5 .dot:nth-child(2) { top: 20px; left: 48px; }
        .face-5 .dot:nth-child(3) { top: 34px; left: 34px; }
        .face-5 .dot:nth-child(4) { top: 48px; left: 20px; }
        .face-5 .dot:nth-child(5) { top: 48px; left: 48px; }
        
        .face-6 .dot:nth-child(1) { top: 20px; left: 20px; }
        .face-6 .dot:nth-child(2) { top: 20px; left: 48px; }
        .face-6 .dot:nth-child(3) { top: 34px; left: 20px; }
        .face-6 .dot:nth-child(4) { top: 34px; left: 48px; }
        .face-6 .dot:nth-child(5) { top: 48px; left: 20px; }
        .face-6 .dot:nth-child(6) { top: 48px; left: 48px; }

        .drag-instruction {
            text-align: center;
            margin-top: 10px;
            color: #bbb;
            font-size: 0.9rem;
        }

        .game-info {
            display: flex;
            justify-content: space-around;
            width: 100%;
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .balance, .total-bet-display, .potential-win-display {
            text-align: center;
        }

        .balance h2, .total-bet-display h2, .potential-win-display h2 {
            font-size: 1.2rem;
            margin-bottom: 5px;
        }

        .balance-value, .total-bet-value, .potential-win-value {
            font-size: 1.8rem;
            font-weight: bold;
        }

        .betting-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            width: 100%;
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .dual-bet-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            width: 100%;
        }

        .bet-box {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            border: 3px solid transparent;
            transition: all 0.3s;
        }

        .bet-box.complete {
            border-color: #4CAF50;
            box-shadow: 0 0 20px rgba(76, 175, 80, 0.5);
        }

        .bet-box h3 {
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .bet-controls {
            display: flex;
            gap: 10px;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
        }

        .bet-btn {
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .bet-btn:hover {
            background: #45a049;
            transform: scale(1.1);
        }

        .bet-input {
            width: 100px;
            padding: 10px;
            border-radius: 5px;
            border: none;
            font-size: 1.2rem;
            text-align: center;
        }

        .number-selection {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .number-option {
            height: 60px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            border: 3px solid transparent;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .number-option:hover {
            transform: scale(1.05);
            background: rgba(255, 255, 255, 0.3);
        }

        .number-option.selected {
            border: 3px solid white;
            box-shadow: 0 0 10px white;
            background: rgba(255, 255, 255, 0.4);
        }

        .number-option.disabled {
            opacity: 0.3;
            cursor: not-allowed;
            pointer-events: none;
        }

        .bet-summary {
            text-align: center;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            margin-top: 10px;
        }

        .game-controls {
            display: flex;
            gap: 15px;
            width: 100%;
            justify-content: center;
        }

        .roll-btn, .clear-btn, .cashout-btn {
            padding: 15px 30px;
            font-size: 1.3rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .roll-btn {
            background: #FF5722;
            color: white;
            flex: 1;
        }

        .roll-btn:hover:not(:disabled) {
            background: #E64A19;
            transform: scale(1.05);
        }

        .roll-btn:disabled {
            background: #9E9E9E;
            cursor: not-allowed;
            transform: none;
        }

        .clear-btn {
            background: #FF9800;
            color: white;
        }

        .clear-btn:hover {
            background: #F57C00;
            transform: scale(1.05);
        }

        .cashout-btn {
            background: #2196F3;
            color: white;
        }

        .cashout-btn:hover {
            background: #1976D2;
            transform: scale(1.05);
        }

        .result-message {
            font-size: 1.5rem;
            font-weight: bold;
            text-align: center;
            min-height: 40px;
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
            width: 100%;
        }

        .result-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: white;
            padding: 40px 60px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            text-align: center;
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            max-width: 90%;
        }

        .result-popup.show {
            transform: translate(-50%, -50%) scale(1);
        }

        .result-popup.win-popup {
            background: linear-gradient(135deg, #4CAF50, #8BC34A);
            color: white;
        }

        .result-popup.lose-popup {
            background: linear-gradient(135deg, #F44336, #E91E63);
            color: white;
        }

        .result-popup h2 {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .result-popup p {
            font-size: 1.3rem;
            margin: 10px 0;
        }

        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 999;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .popup-overlay.show {
            opacity: 1;
            pointer-events: all;
        }

        .history {
            width: 100%;
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .history h2 {
            text-align: center;
            margin-bottom: 10px;
        }

        .history-list {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding: 10px 0;
        }

        .history-item {
            min-width: 80px;
            padding: 10px;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            background: white;
            color: #333;
        }

        .history-item .result-number {
            font-size: 2rem;
            margin-bottom: 5px;
        }

        .history-item .result-status {
            font-size: 0.8rem;
        }

        .instructions {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 15px;
            margin-top: 10px;
            text-align: center;
            width: 100%;
        }

        .instructions h3 {
            margin-bottom: 10px;
            color: #ffd700;
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background-color: #f00;
            opacity: 0;
            pointer-events: none;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }

            .dual-bet-container {
                grid-template-columns: 1fr;
            }

            .game-info {
                flex-direction: column;
                gap: 15px;
            }

            .dice-container {
                width: 280px;
                height: 280px;
                margin: 0 auto;
            }

            #physicsDice {
                width: 60px;
                height: 60px;
                left: 122px;
                top: 120px;
            }

            .cube-face {
                width: 60px;
                height: 60px;
            }

            .face-1 { transform: translateZ(30px); }
            .face-2 { transform: rotateY(180deg) translateZ(30px); }
            .face-3 { transform: rotateY(90deg) translateZ(30px); }
            .face-4 { transform: rotateY(-90deg) translateZ(30px); }
            .face-5 { transform: rotateX(-90deg) translateZ(30px); }
            .face-6 { transform: rotateX(90deg) translateZ(30px); }

            .dot {
                width: 9px;
                height: 9px;
            }

            .face-1 .dot:nth-child(1) { top: 25.5px; left: 25.5px; }
            .face-2 .dot:nth-child(1) { top: 15px; left: 15px; }
            .face-2 .dot:nth-child(2) { top: 36px; left: 36px; }
            .face-3 .dot:nth-child(1) { top: 15px; left: 15px; }
            .face-3 .dot:nth-child(2) { top: 25.5px; left: 25.5px; }
            .face-3 .dot:nth-child(3) { top: 36px; left: 36px; }
            .face-4 .dot:nth-child(1) { top: 15px; left: 15px; }
            .face-4 .dot:nth-child(2) { top: 15px; left: 36px; }
            .face-4 .dot:nth-child(3) { top: 36px; left: 15px; }
            .face-4 .dot:nth-child(4) { top: 36px; left: 36px; }
            .face-5 .dot:nth-child(1) { top: 15px; left: 15px; }
            .face-5 .dot:nth-child(2) { top: 15px; left: 36px; }
            .face-5 .dot:nth-child(3) { top: 25.5px; left: 25.5px; }
            .face-5 .dot:nth-child(4) { top: 36px; left: 15px; }
            .face-5 .dot:nth-child(5) { top: 36px; left: 36px; }
            .face-6 .dot:nth-child(1) { top: 15px; left: 15px; }
            .face-6 .dot:nth-child(2) { top: 15px; left: 36px; }
            .face-6 .dot:nth-child(3) { top: 25.5px; left: 15px; }
            .face-6 .dot:nth-child(4) { top: 25.5px; left: 36px; }
            .face-6 .dot:nth-child(5) { top: 36px; left: 15px; }
            .face-6 .dot:nth-child(6) { top: 36px; left: 36px; }

            .game-controls {
                flex-direction: column;
            }

            .result-popup {
                padding: 30px 40px;
            }

            .result-popup h2 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ðŸŽ² Dual Bet Dice ðŸŽ²</h1>
            <p class="subtitle">Place 2 Bets - Win 6x on Correct Prediction!</p>
        </header>
        
        <div class="dice-area">
            <h2>Throw the Dice</h2>
            <div class="dice-container">
                <div id="physicsDice">
                    <div class="cube-face face-1">
                        <div class="dot"></div>
                    </div>
                    <div class="cube-face face-2">
                        <div class="dot"></div>
                        <div class="dot"></div>
                    </div>
                    <div class="cube-face face-3">
                        <div class="dot"></div>
                        <div class="dot"></div>
                        <div class="dot"></div>
                    </div>
                    <div class="cube-face face-4">
                        <div class="dot"></div>
                        <div class="dot"></div>
                        <div class="dot"></div>
                        <div class="dot"></div>
                    </div>
                    <div class="cube-face face-5">
                        <div class="dot"></div>
                        <div class="dot"></div>
                        <div class="dot"></div>
                        <div class="dot"></div>
                        <div class="dot"></div>
                    </div>
                    <div class="cube-face face-6">
                        <div class="dot"></div>
                        <div class="dot"></div>
                        <div class="dot"></div>
                        <div class="dot"></div>
                        <div class="dot"></div>
                        <div class="dot"></div>
                    </div>
                </div>
            </div>
            <p class="drag-instruction">Click and drag to throw the dice!</p>
        </div>
        
        <div class="game-info">
            <div class="balance">
                <h2>Balance</h2>
                <div class="balance-value">Ksh 1000</div>
            </div>
            <div class="total-bet-display">
                <h2>Total Bet</h2>
                <div class="total-bet-value">Ksh 0</div>
            </div>
            <div class="potential-win-display">
                <h2>Potential Win</h2>
                <div class="potential-win-value">Ksh 0</div>
            </div>
        </div>
        
        <div class="betting-section">
            <h2>âš¡ Place Your Dual Bets âš¡</h2>
            
            <div class="dual-bet-container">
                <!-- Bet 1 -->
                <div class="bet-box" id="bet-box-1">
                    <h3>ðŸŽ¯ Bet #1</h3>
                    
                    <div class="bet-controls">
                        <button class="bet-btn" data-bet="1" data-action="decrease">-</button>
                        <input type="number" class="bet-input" id="bet-amount-1" value="10" min="10">
                        <button class="bet-btn" data-bet="1" data-action="increase">+</button>
                    </div>
                    
                    <h4 style="text-align: center; margin-bottom: 10px;">Select Number</h4>
                    <div class="number-selection" id="numbers-bet-1">
                        <div class="number-option" data-bet="1" data-number="1">1</div>
                        <div class="number-option" data-bet="1" data-number="2">2</div>
                        <div class="number-option" data-bet="1" data-number="3">3</div>
                        <div class="number-option" data-bet="1" data-number="4">4</div>
                        <div class="number-option" data-bet="1" data-number="5">5</div>
                        <div class="number-option" data-bet="1" data-number="6">6</div>
                    </div>
                    
                    <div class="bet-summary" id="summary-1">
                        <div>Bet: <strong>Ksh <span id="bet-1-amount">0</span></strong></div>
                        <div>Number: <strong><span id="bet-1-number">-</span></strong></div>
                        <div>Win: <strong>Ksh <span id="bet-1-win">0</span></strong> (6x)</div>
                    </div>
                </div>
                
                <!-- Bet 2 -->
                <div class="bet-box" id="bet-box-2">
                    <h3>ðŸŽ¯ Bet #2</h3>
                    
                    <div class="bet-controls">
                        <button class="bet-btn" data-bet="2" data-action="decrease">-</button>
                        <input type="number" class="bet-input" id="bet-amount-2" value="10" min="10">
                        <button class="bet-btn" data-bet="2" data-action="increase">+</button>
                    </div>
                    
                    <h4 style="text-align: center; margin-bottom: 10px;">Select Number</h4>
                    <div class="number-selection" id="numbers-bet-2">
                        <div class="number-option" data-bet="2" data-number="1">1</div>
                        <div class="number-option" data-bet="2" data-number="2">2</div>
                        <div class="number-option" data-bet="2" data-number="3">3</div>
                        <div class="number-option" data-bet="2" data-number="4">4</div>
                        <div class="number-option" data-bet="2" data-number="5">5</div>
                        <div class="number-option" data-bet="2" data-number="6">6</div>
                    </div>
                    
                    <div class="bet-summary" id="summary-2">
                        <div>Bet: <strong>Ksh <span id="bet-2-amount">0</span></strong></div>
                        <div>Number: <strong><span id="bet-2-number">-</span></strong></div>
                        <div>Win: <strong>Ksh <span id="bet-2-win">0</span></strong> (6x)</div>
                    </div>
                </div>
            </div>
            
            <div class="game-controls">
                <button class="roll-btn" id="roll-dice" disabled>ðŸŽ² Throw Dice</button>
                <button class="clear-btn" id="clear-bets">ðŸ”„ Clear Bets</button>
                <button class="cashout-btn" id="cash-out">ðŸ’° Cash Out</button>
            </div>
            
            <div class="result-message" id="result-message"></div>
        </div>

        <div class="popup-overlay" id="popup-overlay"></div>
        <div class="result-popup" id="result-popup">
            <h2 id="popup-title"></h2>
            <p id="popup-message"></p>
            <p id="popup-amount"></p>
        </div>
        
        <div class="instructions">
            <h3>ðŸ“‹ How to Play</h3>
            <p>âœ… Place TWO bets with different amounts and numbers</p>
            <p>ðŸŽ² Throw the dice - one bet wins, one loses</p>
            <p>ðŸ’° Winning bet pays 6x your stake!</p>
            <p>ðŸŽ¯ Example: Bet Ksh 50 on "3" and Ksh 30 on "5". If dice shows 3, you win Ksh 300!</p>
        </div>
        
        <div class="history">
            <h2>Game History</h2>
            <div class="history-list" id="history-list"></div>
        </div>
    </div>

    <script>
        class PerfectPhysicsDice {
            constructor(container) {
                this.container = container;
                this.dice = document.getElementById('physicsDice');
                this.isRolling = false;
                this.dragging = false;
                this.dragStart = { x: 0, y: 0 };
                
                this.isMobile = window.innerWidth <= 768;
                
                this.position = { x: this.isMobile ? 110 : 150, y: this.isMobile ? 110 : 150 };
                this.velocity = { x: 0, y: 0 };
                
                this.rotation = { x: 0, y: 0, z: 0 };
                this.angularVelocity = { x: 0, y: 0, z: 0 };
                
                this.friction = 0.98;
                this.bounceDamping = 0.5;
                this.gravity = 0.3;
                this.diceSize = this.isMobile ? 60 : 80;
                this.containerWidth = this.isMobile ? 220 : 320;
                this.containerHeight = this.isMobile ? 220 : 320;
                this.angularFriction = 0.985;
                
                this.finalResult = null;
                this.rollDuration = 1800;
                this.rollStartTime = null;
                
                this.setupEventListeners();
                this.animate();
            }
            
            setupEventListeners() {
                this.container.addEventListener('mousedown', (e) => this.startDrag(e));
                this.container.addEventListener('mousemove', (e) => this.drag(e));
                this.container.addEventListener('mouseup', (e) => this.endDrag(e));
                this.container.addEventListener('mouseleave', (e) => this.cancelDrag(e));
                
                this.container.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    this.startDrag(e.touches[0]);
                });
                this.container.addEventListener('touchmove', (e) => {
                    e.preventDefault();
                    this.drag(e.touches[0]);
                });
                this.container.addEventListener('touchend', (e) => this.endDrag(e));
            }
            
            startDrag(e) {
                if (this.isRolling) return;
                
                const rect = this.container.getBoundingClientRect();
                this.dragStart.x = e.clientX - rect.left;
                this.dragStart.y = e.clientY - rect.top;
                this.dragging = true;
            }
            
            drag(e) {
                if (!this.dragging) return;
                
                const rect = this.container.getBoundingClientRect();
                this.dragEnd = {
                    x: e.clientX - rect.left,
                    y: e.clientY - rect.top
                };
            }
            
            endDrag() {
                if (!this.dragging) return;
                
                const dx = this.dragStart.x - this.dragEnd.x;
                const dy = this.dragStart.y - this.dragEnd.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance > 5) {
                    this.startRoll(dx, dy);
                }
                
                this.dragging = false;
                this.dragEnd = null;
            }
            
            cancelDrag() {
                this.dragging = false;
                this.dragEnd = null;
            }
            
            startRoll(dx, dy) {
                this.finalResult = Math.floor(Math.random() * 6) + 1;
                
                const forceMultiplier = 0.25;
                this.velocity.x = dx * forceMultiplier;
                this.velocity.y = dy * forceMultiplier;
                
                this.angularVelocity.x = -dy * 0.025;
                this.angularVelocity.y = dx * 0.025;
                this.angularVelocity.z = (dx - dy) * 0.01;
                
                this.isRolling = true;
                this.rollStartTime = Date.now();
                rollDiceBtn.disabled = true;
                resultMessage.textContent = 'Rolling...';
                
                gameState.balance -= gameState.bet1.amount + gameState.bet2.amount;
                updateDisplay();
                
                setTimeout(() => {
                    this.smoothLanding();
                }, this.rollDuration);
            }
            
            update() {
                if (!this.isRolling) return;
                
                const elapsed = Date.now() - this.rollStartTime;
                const progress = Math.min(elapsed / this.rollDuration, 1);
                const slowdownFactor = 1 - (progress * 0.5);
                
                this.position.x += this.velocity.x * slowdownFactor;
                this.position.y += this.velocity.y * slowdownFactor;
                this.velocity.y += this.gravity * slowdownFactor;
                
                this.rotation.x += this.angularVelocity.x * slowdownFactor;
                this.rotation.y += this.angularVelocity.y * slowdownFactor;
                this.rotation.z += this.angularVelocity.z * slowdownFactor;
                
                this.handleCollisions();
                
                this.velocity.x *= this.friction;
                this.velocity.y *= this.friction;
                this.angularVelocity.x *= this.angularFriction;
                this.angularVelocity.y *= this.angularFriction;
                this.angularVelocity.z *= this.angularFriction;
                
                this.dice.style.left = `${this.position.x}px`;
                this.dice.style.top = `${this.position.y}px`;
                this.dice.style.transform = `
                    rotateX(${this.rotation.x}rad) 
                    rotateY(${this.rotation.y}rad) 
                    rotateZ(${this.rotation.z}rad)
                `;
            }
            
            handleCollisions() {
                const halfSize = this.diceSize / 2;
                const padding = 5;
                
                if (this.position.x - halfSize < padding) {
                    this.position.x = halfSize + padding;
                    this.velocity.x = Math.abs(this.velocity.x) * this.bounceDamping;
                }
                else if (this.position.x + halfSize > this.containerWidth - padding) {
                    this.position.x = this.containerWidth - halfSize - padding;
                    this.velocity.x = -Math.abs(this.velocity.x) * this.bounceDamping;
                }
                
                if (this.position.y - halfSize < padding) {
                    this.position.y = halfSize + padding;
                    this.velocity.y = Math.abs(this.velocity.y) * this.bounceDamping;
                }
                else if (this.position.y + halfSize > this.containerHeight - padding) {
                    this.position.y = this.containerHeight - halfSize - padding;
                    this.velocity.y = -Math.abs(this.velocity.y) * this.bounceDamping;
                }
            }
            
            smoothLanding() {
                this.velocity.x = 0;
                this.velocity.y = 0;
                this.angularVelocity.x = 0;
                this.angularVelocity.y = 0;
                this.angularVelocity.z = 0;
                
                this.snapToResult(this.finalResult);
            }
            
            snapToResult(result) {
                let targetRotationX, targetRotationY, targetRotationZ;
                
                switch(result) {
                    case 1:
                        targetRotationX = 0;
                        targetRotationY = 0;
                        targetRotationZ = 0;
                        break;
                    case 2:
                        targetRotationX = 0;
                        targetRotationY = Math.PI;
                        targetRotationZ = 0;
                        break;
                    case 4:
                        targetRotationX = 0;
                        targetRotationY = Math.PI / 2;
                        targetRotationZ = 0;
                        break;
                    case 3:
                        targetRotationX = 0;
                        targetRotationY = -Math.PI / 2;
                        targetRotationZ = 0;
                        break;
                    case 6:
                        targetRotationX = -Math.PI / 2;
                        targetRotationY = 0;
                        targetRotationZ = 0;
                        break;
                    case 5:
                        targetRotationX = Math.PI / 2;
                        targetRotationY = 0;
                        targetRotationZ = 0;
                        break;
                }
                
                this.animateToFinalPosition(targetRotationX, targetRotationY, targetRotationZ, result);
            }
            
            animateToFinalPosition(targetX, targetY, targetZ, result) {
                const duration = 400;
                const startTime = Date.now();
                const startRotation = { ...this.rotation };
                
                const animate = () => {
                    const elapsed = Date.now() - startTime;
                    const progress = Math.min(elapsed / duration, 1);
                    const easeOut = 1 - Math.pow(1 - progress, 3);
                    
                    this.rotation.x = startRotation.x + (targetX - startRotation.x) * easeOut;
                    this.rotation.y = startRotation.y + (targetY - startRotation.y) * easeOut;
                    this.rotation.z = startRotation.z + (targetZ - startRotation.z) * easeOut;
                    
                    this.dice.style.transform = `
                        rotateX(${this.rotation.x}rad) 
                        rotateY(${this.rotation.y}rad) 
                        rotateZ(${this.rotation.z}rad)
                    `;
                    
                    if (progress < 1) {
                        requestAnimationFrame(animate);
                    } else {
                        this.isRolling = false;
                        setTimeout(() => {
                            finishRoll(result);
                            rollDiceBtn.disabled = !areBothBetsComplete();
                        }, 100);
                    }
                };
                
                animate();
            }
            
            animate() {
                this.update();
                requestAnimationFrame(() => this.animate());
            }
            
            quickThrow() {
                if (this.isRolling) return;
                
                this.finalResult = Math.floor(Math.random() * 6) + 1;
                
                this.velocity.x = (Math.random() - 0.5) * 5;
                this.velocity.y = (Math.random() - 0.5) * 3;
                this.angularVelocity.x = (Math.random() - 0.5) * 0.3;
                this.angularVelocity.y = (Math.random() - 0.5) * 0.3;
                this.angularVelocity.z = (Math.random() - 0.5) * 0.15;
                
                this.isRolling = true;
                this.rollStartTime = Date.now();
                rollDiceBtn.disabled = true;
                
                gameState.balance -= gameState.bet1.amount + gameState.bet2.amount;
                updateDisplay();
                
                resultMessage.textContent = 'Rolling...';
                
                setTimeout(() => {
                    this.smoothLanding();
                }, this.rollDuration);
            }
        }

        const gameState = {
            balance: 1000,
            bet1: {
                amount: 0,
                number: null
            },
            bet2: {
                amount: 0,
                number: null
            },
            history: []
        };

        const balanceValue = document.querySelector('.balance-value');
        const totalBetValue = document.querySelector('.total-bet-value');
        const potentialWinValue = document.querySelector('.potential-win-value');
        const rollDiceBtn = document.getElementById('roll-dice');
        const clearBetsBtn = document.getElementById('clear-bets');
        const cashOutBtn = document.getElementById('cash-out');
        const resultMessage = document.getElementById('result-message');
        const historyList = document.getElementById('history-list');
        const diceContainer = document.querySelector('.dice-container');

        const perfectDice = new PerfectPhysicsDice(diceContainer);

        function initGame() {
            updateDisplay();
            setupBetControls();
            
            rollDiceBtn.addEventListener('click', () => perfectDice.quickThrow());
            clearBetsBtn.addEventListener('click', clearAllBets);
            cashOutBtn.addEventListener('click', cashOut);
        }

        function setupBetControls() {
            document.querySelectorAll('.bet-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const betNum = e.target.dataset.bet;
                    const action = e.target.dataset.action;
                    adjustBet(betNum, action === 'increase' ? 10 : -10);
                });
            });

            document.querySelectorAll('.bet-input').forEach(input => {
                input.addEventListener('change', (e) => {
                    const betNum = e.target.id.includes('1') ? '1' : '2';
                    updateBetFromInput(betNum, parseInt(e.target.value));
                });
            });

            document.querySelectorAll('.number-option').forEach(option => {
                option.addEventListener('click', (e) => {
                    const betNum = e.target.dataset.bet;
                    const number = parseInt(e.target.dataset.number);
                    selectNumber(betNum, number);
                });
            });
        }

        function adjustBet(betNum, amount) {
            const input = document.getElementById(`bet-amount-${betNum}`);
            const currentBet = parseInt(input.value) || 0;
            const newBet = Math.max(10, currentBet + amount);
            
            if (newBet <= gameState.balance) {
                input.value = newBet;
                updateBetFromInput(betNum, newBet);
            }
        }

        function updateBetFromInput(betNum, amount) {
            amount = Math.max(10, Math.min(amount, gameState.balance));
            
            const bet = betNum === '1' ? gameState.bet1 : gameState.bet2;
            bet.amount = amount;
            
            document.getElementById(`bet-amount-${betNum}`).value = amount;
            updateDisplay();
            updateBetBox(betNum);
        }

        function selectNumber(betNum, number) {
            const bet = betNum === '1' ? gameState.bet1 : gameState.bet2;
            const otherBet = betNum === '1' ? gameState.bet2 : gameState.bet1;
            
            bet.number = number;
            
            document.querySelectorAll(`[data-bet="${betNum}"].number-option`).forEach(opt => {
                opt.classList.remove('selected');
                if (parseInt(opt.dataset.number) === number) {
                    opt.classList.add('selected');
                }
            });
            
            updateNumberAvailability();
            updateDisplay();
            updateBetBox(betNum);
        }

        function updateNumberAvailability() {
            const num1 = gameState.bet1.number;
            const num2 = gameState.bet2.number;
            
            document.querySelectorAll('[data-bet="1"].number-option').forEach(opt => {
                const num = parseInt(opt.dataset.number);
                if (num === num2) {
                    opt.classList.add('disabled');
                } else {
                    opt.classList.remove('disabled');
                }
            });
            
            document.querySelectorAll('[data-bet="2"].number-option').forEach(opt => {
                const num = parseInt(opt.dataset.number);
                if (num === num1) {
                    opt.classList.add('disabled');
                } else {
                    opt.classList.remove('disabled');
                }
            });
        }

        function updateBetBox(betNum) {
            const bet = betNum === '1' ? gameState.bet1 : gameState.bet2;
            const isComplete = bet.amount > 0 && bet.number !== null;
            
            const box = document.getElementById(`bet-box-${betNum}`);
            if (isComplete) {
                box.classList.add('complete');
            } else {
                box.classList.remove('complete');
            }
            
            document.getElementById(`bet-${betNum}-amount`).textContent = bet.amount;
            document.getElementById(`bet-${betNum}-number`).textContent = bet.number || '-';
            document.getElementById(`bet-${betNum}-win`).textContent = bet.amount * 6;
        }

        function areBothBetsComplete() {
            return gameState.bet1.amount > 0 && gameState.bet1.number !== null &&
                   gameState.bet2.amount > 0 && gameState.bet2.number !== null &&
                   gameState.bet1.number !== gameState.bet2.number;
        }

        function updateDisplay() {
            balanceValue.textContent = `Ksh ${gameState.balance}`;
            
            const totalBet = gameState.bet1.amount + gameState.bet2.amount;
            totalBetValue.textContent = `Ksh ${totalBet}`;
            
            let potentialWin = 0;
            if (gameState.bet1.amount > 0 && gameState.bet1.number !== null) {
                potentialWin = Math.max(potentialWin, gameState.bet1.amount * 6);
            }
            if (gameState.bet2.amount > 0 && gameState.bet2.number !== null) {
                potentialWin = Math.max(potentialWin, gameState.bet2.amount * 6);
            }
            potentialWinValue.textContent = `Ksh ${potentialWin}`;
            
            rollDiceBtn.disabled = !areBothBetsComplete();
            
            updateBetBox('1');
            updateBetBox('2');
        }

        function finishRoll(result) {
            const bet1Won = result === gameState.bet1.number;
            const bet2Won = result === gameState.bet2.number;
            
            let winAmount = 0;
            let winningBet = null;
            
            if (bet1Won) {
                winAmount = gameState.bet1.amount * 6;
                winningBet = 1;
            } else if (bet2Won) {
                winAmount = gameState.bet2.amount * 6;
                winningBet = 2;
            }
            
            const popup = document.getElementById('result-popup');
            const popupOverlay = document.getElementById('popup-overlay');
            const popupTitle = document.getElementById('popup-title');
            const popupMessage = document.getElementById('popup-message');
            const popupAmount = document.getElementById('popup-amount');
            
            if (winningBet) {
                gameState.balance += winAmount;
                
                popup.className = 'result-popup win-popup show';
                popupTitle.textContent = 'ðŸŽ‰ YOU WIN! ðŸŽ‰';
                popupMessage.textContent = `Dice: ${result} | Bet #${winningBet} Won!`;
                popupAmount.textContent = `You won Ksh ${winAmount} (6x payout)!`;
                
                playWinSound();
                createConfetti();
            } else {
                popup.className = 'result-popup lose-popup show';
                popupTitle.textContent = 'ðŸ˜ž BOTH BETS LOST';
                popupMessage.textContent = `Dice showed ${result}`;
                popupAmount.textContent = `Better luck next time!`;
                
                playLoseSound();
            }
            
            popupOverlay.classList.add('show');
            
            setTimeout(() => {
                popup.classList.remove('show');
                popupOverlay.classList.remove('show');
            }, 3500);
            
            addToHistory(result, winningBet, winAmount);
            
            clearAllBets();
            updateDisplay();
        }

        function clearAllBets() {
            gameState.bet1 = { amount: 0, number: null };
            gameState.bet2 = { amount: 0, number: null };
            
            document.getElementById('bet-amount-1').value = 10;
            document.getElementById('bet-amount-2').value = 10;
            
            document.querySelectorAll('.number-option').forEach(opt => {
                opt.classList.remove('selected', 'disabled');
            });
            
            document.querySelectorAll('.bet-box').forEach(box => {
                box.classList.remove('complete');
            });
            
            resultMessage.textContent = '';
            updateDisplay();
        }

        function cashOut() {
            if (perfectDice.isRolling) {
                resultMessage.textContent = "Please wait for the current roll to finish!";
                return;
            }
            
            resultMessage.textContent = `ðŸ’° Cashed out Ksh ${gameState.balance}!`;
            resultMessage.style.color = '#4CAF50';
            
            setTimeout(() => {
                resultMessage.textContent = '';
            }, 3000);
        }

        function addToHistory(result, winningBet, winAmount) {
            const historyItem = document.createElement('div');
            historyItem.className = 'history-item';
            
            const resultNum = document.createElement('div');
            resultNum.className = 'result-number';
            resultNum.textContent = result;
            
            const resultStatus = document.createElement('div');
            resultStatus.className = 'result-status';
            
            if (winningBet) {
                resultStatus.textContent = `Bet ${winningBet} Won`;
                historyItem.style.background = '#4CAF50';
                historyItem.title = `Won Ksh ${winAmount}`;
            } else {
                resultStatus.textContent = 'Lost';
                historyItem.style.background = '#F44336';
                historyItem.title = 'Both bets lost';
            }
            
            historyItem.appendChild(resultNum);
            historyItem.appendChild(resultStatus);
            historyItem.style.color = 'white';
            
            historyList.prepend(historyItem);
            
            if (historyList.children.length > 10) {
                historyList.removeChild(historyList.lastChild);
            }
        }

        function playWinSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const notes = [523.25, 659.25, 783.99, 1046.50];
                notes.forEach((freq, i) => {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.setValueAtTime(freq, audioContext.currentTime + i * 0.1);
                    oscillator.type = 'sine';
                    
                    gainNode.gain.setValueAtTime(0, audioContext.currentTime + i * 0.1);
                    gainNode.gain.linearRampToValueAtTime(0.15, audioContext.currentTime + i * 0.1 + 0.01);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + i * 0.1 + 0.3);
                    
                    oscillator.start(audioContext.currentTime + i * 0.1);
                    oscillator.stop(audioContext.currentTime + i * 0.1 + 0.3);
                });
            } catch (e) {
                console.log('Audio not supported');
            }
        }

        function playLoseSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.type = 'triangle';
                oscillator.frequency.setValueAtTime(440, audioContext.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(220, audioContext.currentTime + 0.5);
                
                gainNode.gain.setValueAtTime(0.15, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                
                oscillator.start();
                oscillator.stop(audioContext.currentTime + 0.5);
            } catch (e) {
                console.log('Audio not supported');
            }
        }

        function createConfetti() {
            const colors = ['#FF5252', '#4CAF50', '#2196F3', '#FFC107', '#9C27B0', '#FF9800'];
            
            for (let i = 0; i < 100; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.top = '-10px';
                confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
                document.body.appendChild(confetti);
                
                const animation = confetti.animate([
                    { transform: 'translateY(0) rotate(0deg)', opacity: 1 },
                    { transform: `translateY(${100 + Math.random() * 50}vh) rotate(${360 + Math.random() * 360}deg)`, opacity: 0 }
                ], {
                    duration: 2000 + Math.random() * 2000,
                    easing: 'cubic-bezier(0.1, 0.8, 0.2, 1)'
                });
                
                animation.onfinish = () => {
                    document.body.removeChild(confetti);
                };
            }
        }

        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>